{"version":3,"names":["Timer","getCachedSessionId","getTracingHeadersFromAttributes","getTracingAttributes","DATADOG_GRAPH_QL_OPERATION_NAME_HEADER","DATADOG_GRAPH_QL_OPERATION_TYPE_HEADER","DATADOG_GRAPH_QL_VARIABLES_HEADER","isDatadogCustomHeader","RequestProxy","URLHostParser","calculateResponseSize","RESPONSE_START_LABEL","XHRProxy","constructor","providers","onTrackingStart","context","originalXhrOpen","xhrType","prototype","open","originalXhrSend","send","originalXhrSetRequestHeader","setRequestHeader","proxyRequests","onTrackingStop","proxyOpen","proxySend","proxySetRequestHeader","firstPartyHostsRegexMap","tracingSamplingRate","method","url","hostname","_datadog_xhr","reported","timer","graphql","tracingAttributes","rumSessionId","apply","arguments","start","tracingHeaders","forEach","header","value","proxyOnReadyStateChange","xhrProxy","originalOnreadystatechange","onreadystatechange","readyState","DONE","reportXhr","resourceReporter","HEADERS_RECEIVED","recordTick","responseSize","key","startTime","stop","reportResource","request","kind","graphqlAttributes","response","statusCode","status","size","timings","stopTime","responseStartTime","hasTickFor","timeAt","undefined","resourceContext","sendRequestHeader","operationName","operationType","variables"],"sourceRoot":"../../../../../../../src","sources":["rum/instrumentation/resourceTracking/requestProxy/XHRProxy/XHRProxy.ts"],"mappings":"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","ignoreList":[]}
