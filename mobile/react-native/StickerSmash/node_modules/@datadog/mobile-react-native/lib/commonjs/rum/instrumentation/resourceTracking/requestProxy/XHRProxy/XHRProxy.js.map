{"version":3,"names":["_Timer","require","_sessionIdHelper","_distributedTracingHeaders","_distributedTracing","_graphqlHeaders","_RequestProxy","_URLHostParser","_responseSize","RESPONSE_START_LABEL","XHRProxy","RequestProxy","constructor","providers","onTrackingStart","context","originalXhrOpen","xhrType","prototype","open","originalXhrSend","send","originalXhrSetRequestHeader","setRequestHeader","proxyRequests","onTrackingStop","exports","proxyOpen","proxySend","proxySetRequestHeader","firstPartyHostsRegexMap","tracingSamplingRate","method","url","hostname","URLHostParser","_datadog_xhr","reported","timer","Timer","graphql","tracingAttributes","getTracingAttributes","rumSessionId","getCachedSessionId","apply","arguments","start","tracingHeaders","getTracingHeadersFromAttributes","forEach","header","value","proxyOnReadyStateChange","xhrProxy","originalOnreadystatechange","onreadystatechange","readyState","DONE","reportXhr","resourceReporter","HEADERS_RECEIVED","recordTick","responseSize","calculateResponseSize","key","startTime","stop","reportResource","request","kind","graphqlAttributes","response","statusCode","status","size","timings","stopTime","responseStartTime","hasTickFor","timeAt","undefined","resourceContext","sendRequestHeader","isDatadogCustomHeader","DATADOG_GRAPH_QL_OPERATION_NAME_HEADER","operationName","DATADOG_GRAPH_QL_OPERATION_TYPE_HEADER","operationType","DATADOG_GRAPH_QL_VARIABLES_HEADER","variables"],"sourceRoot":"../../../../../../../src","sources":["rum/instrumentation/resourceTracking/requestProxy/XHRProxy/XHRProxy.ts"],"mappings":"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","ignoreList":[]}
